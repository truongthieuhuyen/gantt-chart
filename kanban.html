<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban board</title>

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="app.css">
    <!-- font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- jquery -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> -->
    <!-- moment -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/locale/vi.js"></script>
    <!-- sweetalert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- droppable -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


    <style>
        main {
            background-image: url(https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80);
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        .todo-container {
            /* overflow: hidden; */
        }

        .status .column-tasks {
            overflow: visible;
        }

        .todo {
            z-index: 9;
        }
    </style>
</head>

<body>
    <main>

        <section id="jira-section">
            <!-- Modal -->
            <div class="modal fade " id="todo_form" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
                data-bs-backdrop="static" data-bs-keyboard="false">
                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Create new task</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="todo_input" />
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary close-modal"
                                data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" id="todo_submit">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Display -->
            <div class="row todo-container">
                <div class="col status column-todo" id="column-todo">
                    <div class="column-title">
                        <h5>To do</h5>

                        <button id="add_btn" data-bs-toggle="modal" data-bs-target="#todo_form">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="column-tasks">
                        <div class="todo">
                            <p class="todo-title">Demo task</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    5
                                    <div class="shortcut-priority priority-high">
                                        <i class="fas fa-angle-up"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>

                        <div class="todo">
                            <p class="todo-title">Food Research</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    1
                                    <div class="shortcut-priority priority-low">
                                        <i class="fas fa-angle-double-down"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>

                        <div class="todo">
                            <p class="todo-title">Mind Mapping</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    1
                                    <div class="shortcut-priority priority-low">
                                        <i class="fas fa-angle-down"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="col status column-in-progress" id="column-in-progress">
                    <div class="column-title">
                        <h5>In progress</h5>

                    </div>
                    <div class="column-tasks">
                        <div class="todo">
                            <p class="todo-title">UI Animation</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    9
                                    <div class="shortcut-priority priority-medium">
                                        <i class="fas fa-grip-lines"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col status column-in-review" id="column-in-revi ew">
                    <div class="column-title">
                        <h5>In review</h5>

                    </div>
                    <div class="column-tasks">
                        <div class="todo">
                            <p class="todo-title">User interface</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    6
                                    <div class="shortcut-priority priority-medium">
                                        <i class="fas fa-grip-lines"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col status column-in-testing" id="column-in-testing">
                    <div class="column-title">
                        <h5>In testing</h5>

                    </div>
                    <div class="column-tasks">
                        <div class="todo">
                            <p class="todo-title">Create dynamically content for marketing campaign</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    2
                                    <div class="shortcut-priority priority-highest">
                                        <i class="fas fa-angle-double-up"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col status column-done" id="column-done">
                    <div class="column-title">
                        <h5>Done</h5>

                    </div>
                    <div class="column-tasks">
                        <div class="todo" id="drag-something">
                            <p class="todo-title">Mockups</p>
                            <span class="close">&times;</span>
                            <div class="todo-text">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellendus
                                deleniti eos, itaque autem impedit dolores culpa incidunt similique id suscipit in
                                aliquam quisquam nam et veritatis eligendi iste amet iure!
                            </div>
                            <div class="todo-shortcut">
                                <div class="shortcut-type ">
                                    <i class="fas fa-paperclip"></i>
                                    2
                                    <div class="shortcut-priority priority-highest">
                                        <i class="fas fa-angle-double-up"></i>
                                    </div>
                                </div>
                                <div class="shortcut-assignee">
                                    <img src="images/Frame 1141.png" alt="">
                                    <img src="images/Frame 1149.png" alt="">
                                    <img src="images/Frame 1184.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <a class="btn btn-primary" href="index.html" role="button">Trở về</a>
    </main>

    <script>
        const todoTasks = $('.todo');
        const boxes = $('.column-tasks');
        let dragItem = null;

        /* 
         * ____________________________________________ Drag events 
         */
        $(function () {
            // task
            todoTasks.draggable({
                start: function () {
                    dragItem = this;
                    $(this).toggleClass('changed')
                    boxes.not($(this).parent()).addClass('changed')

                },
                drag: function () {
                    $(this).parent().parent().addClass('changed')
                },
                stop: function () {
                    $(this).toggleClass('changed')
                    boxes.removeClass('changed')
                    $(this).css({ 'top': 'unset', 'left': 'unset' })
                    $('.status').removeClass('changed')
                },
            });

            // column container
            boxes.droppable({
                // over: function (event, ui) {
                //     $(this).parent().addClass('changed')
                // },
                drop: function (event, ui) {
                    $(this)
                        .addClass("ui-state-highlight changed")
                        .append(dragItem)
                },
            });
        });


        /**
         * _________________________________________ Create & delete todo task
         */
        const todoSubmit = $("#todo_submit");
        $(todoSubmit).on('click', createTodoTask);
        var random = Math.floor(Math.random() * 1000000);

        function createTodoTask() {
            var todo_div = '<div class="todo" draggable="true" id="task-' + random + '">';
            var input_val = $("#todo_input").val();
            todo_div += '' + input_val + '<span class="close">&times;</span></div>';


            $('#column-todo .column-tasks').append(todo_div);

            // gán sự kiện cho task mới vừa tạo
            $('.todo').off('dragstart').on("dragstart", dragStart);
            $('.todo').off('dragend').on("dragend", dragEnd);

            // reset
            $('#todo_input').val("");
            $('.close-modal').click();
            Swal.fire({
                title: 'Created new task!',
                icon: 'success',
                showConfirmButton: false,
                timer: 2500
            })
        }
        function deleteTodoTask(id) {
            $('#' + id).remove();
        }



        $('.status').on('click', '.close', function () {
            Swal.fire({
                title: 'Do you want to delete this task?',
                showDenyButton: true,
                confirmButtonText: 'Yes',
                denyButtonText: 'No',
            }).then((result) => {
                if (result.isConfirmed) {
                    deleteTodoTask($(this).parent().attr('id'))
                    Swal.fire({
                        title: 'Deleted!',
                        icon: 'success',
                        showConfirmButton: false,
                        timer: 2500
                    })
                } else if (result.isDenied) {
                    Swal.fire('Canceled', '', 'info')
                }
            })

        });
    </script>
</body>

</html>